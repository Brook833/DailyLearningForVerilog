# 第四章 运算符、赋值语句和结构说明语句

## 概述
在本章中我们将学习Verilog语法中关于各种运算符、赋值语句、结构说明语句等基本语法要素。这些内容看起来简单，但有很多地方与C语言不同，例如拼接运算符、缩减运算符、阻塞和非阻塞赋值运算符和结构说明语句中的并行块等。

## 4.1 逻辑运算符
在Verilog HDL语言中存在3种逻辑运算符:
(1) && 逻辑与
(2) || 逻辑或
(3) !  逻辑非

`&&`和`||`是双目运算符。
`!`是单目运算符

逻辑运算符种`&&`和`||`的优先级低于关系运算符，`!`高于算数运算符

```verilog
a == b || a == c;
!a || a > b
```

## 4.2 关系运算符
关系运算符共有以下4种:
(1) a < b
(2) a > b
(3) a <= b
(4) a >= b

在进行关系运算时，如果声明的关系是假的(flase)，则返回值是0。如果某个操作数的值不定，则关系是模糊的，返回值是不定值。

所有的关系运算符有着相同的优先级。关系运算符的优先级低于算数运算符的优先级。

## 4.3 等式运算符
在Verilog HDL语言存在4种等式运算符:
(1) ==    // 等于
(2) !=    // 不等于
(3) ===   // 等于
(4) !===  // 不等于

**注意:求反号、双等号、三个等号之间不能有空格。**

这四个运算符都是双目运算符，它要求有两个操作数。

`==`和`！=`又称为逻辑等式运算符。
由于操作数中的某些位可能是不定值和高阻值z，结果可能为不定值x。

`===`和`!===`又称为case等式运算符
它在对操作数进行比较时对某些位的不定值x和高阻值z也进行比较，两个操作数必须完全一致，其结果才是1，否则是0。

这4个等式运算符的优先级别是相同的。

## 4.4 移位运算符
在Verilog HDL中有两种移位运算符:
(1) `<<`
(2) `>>`

这两种移位运算都用0来填补移出的空位。

## 4.5 位拼接运算符
在Verilog HDL语言中有一个特殊的运算符,位拼接运算符
(1) `{}`

这个运算符可以把两个或多个信号的某些位拼接起来进行运算操作。其使用方法如下:

{信号1的某几位，信号2的某几位---}

`a, b[3:0], w, 3'b101`

在位拼接表达式中不允许存在没有指明位数的信号。这是因为在计算拼接信号位宽的大小时必须知道其中每个信号的位宽。

位拼接可以用重复法来简化表达式:
`{4{w}}`  // 等同于`{w,w,w,w}`

位拼接还可以用嵌套的方式来表达:
`{b, {3{a, b}}}` // 等同于`{b, a, b, a, b, a, b}`

用于表示重复的表达式，如上例中的4和3，必须是常数表达式。

## 4.6 缩减运算符
缩减运算符(reduction operator)是单目运算符，也有与或非运算。其与或非运算规则类似于位运算符的与或非规则，但其运算过程不同。

位运算是对操作数的相应位进行与或非操作，原操作数是几位，运算结果也是几位。

而缩减运算则不同，缩减运算是对单个操作数进行与或飞递推运算，最后的结果是1位的二进制数。

缩减运算的具体运算过程是这样的:
(1) 第一步先将操作数的第1位与第2位进行与或非运算。
(2) 第二步将运算结果与第3位进行与或非运算。
以此类推，直至最后一位。

```verilog
reg [3:0] B;
reg C;
    C = &B;
```

相当于
`C = ((B[0] & B[1]) & B[2]) & B[3]`;

## 4.7 优先级别
下面对各种运算符的优先级别关系做一总结:
(1) `! ~`               // 高
(2) `* / %`
(3) `+ -`
(4) `<< >>`
(5) `< <= > >=`
(6) `== != === !===`
(7) `&`
(8) `^ ^~`
(9) `!`
(10)`|`
(11)`&&`
(12)`||`
(13)`?:`                // 低

## 4.8 关键词

### 4.9.1 赋值语句
在Verilog HDL语言中，信号有两种赋值方式:

#### 1. 非阻塞(Non_Blocking)赋值方式(如b<=a;)
(1) 在语句块中，上面语句所赋的变量值不能立即就为下面的语句所用;
(2) 块结束后才能完成这次赋值操作，而所赋的变量是上一次赋值得到的；
(3) 在编写可综合的时序逻辑模块时，这是最常用的赋值方法。

**注意:非阻塞赋值`<=`与小于等于符看起来相同，但意义完全不同。**
#### 2. 阻塞(Blocking)赋值方式(如b=a;)
(1) 赋值语句执行完后，块才结束；
(2) b的值在赋值语句执行完后立刻就改变的；
(3) 在时序逻辑中使用时，可能会产生意想不到的结果。

非阻塞赋值方式和阻塞赋值方式的区别常给设计人员带来问题。

问题主要是对`always`块内的reg型信号的赋值方式不易把握。

非阻塞赋值`b<=a;`，这种方式的赋值并不是马上执行的，也就是说`always`块内的下一条语句执行后，b并不等于a，而是保持原来的值，always块结束后，才进行赋值。

阻塞赋值`b=a`,这种方式的赋值是马上执行的，也就是说执行下一条语句时，b已经等于a。

### 4.9.2 块语句

