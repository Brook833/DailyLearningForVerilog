# 第五章 条件语句、循环语句、块语句与生成语句

## 概述
在本章中将详细的学习Verilog语法中的条件语句、循环语句、块语句和盛生成语句的写法。其中生成语句时Verilog1364-2001版标准新添加的语句。这些语句中有些与C语言很类似，所以比较容易理解。但也有些与C语言不同，如块语句、生成语句、casex和casez等。

## 5.1 条件语句(if_else语句)
Verilog HDL语言提供了3种形式的if语句。
(1)
```verilog
if (a > b)
    out1 = in1;
```
(2)
```verilog
if(a > b)
    out1 = int1;
else
    out1 = int2;
```
(3)
```verilog
if (a > b)
    out1 = int1;
else if(a < b)
    out1 = int2;
else 
    out1 = int3;
```

**注意:条件语句必须在过程块语句中使用。所谓过程块语句是指由initial和always语句引导的执行语句集合。除这两种块语句引导的begin end块中可以编写条件语句外，模块中的其他地方都不能编写。**

5点说明:
(1) 3种形式的if语句种在if后面都有表达式，一般为逻辑表达式或关系表达式。系统对表达式的值进行判断，若为0,x,z，按假处理，若为1，则为真。 
(2) 第2,3种形式的if语句，在每个else前都有一个分号；整个语句结束处有一分号。
(3) if和else中可以包含一个内嵌的操作语句，也可以有多个操作语句，此时用begin和end这两个关键词i昂几个语句包含起来成为一个复合块语句。
```verilog
if (a > b)
    begin
        out1 <= int1;
        out2 <= int2;
    end
else
    begin
        out1 <= int2;
        out2 <= int1;
    end
```
(4) 允许一定形式的表达式简写方式`if (expr)`等价于`if(expr == 1)`
(5) if语句允许嵌套

## 5.2 case语句
case语句是一种多分支选择语句，if语句只有两个分支可供选择，而实际问题中常常需要用到多分支选择，Verilog语言提供的case语句直接处理多分支选择。case语句通常用于微处理器的指令译码，一般形式如下:
(1) case(expr) <case分支项> endcase
(2) casez(expr) <case分支项> endcase
(3) casex(expr) <case分支项> endcase

case分支项的一般格式如下:
分支表达式: 语句;
默认项(default): 语句;

说明:
(1) case括弧内的表达式称为控制表达式，case分支项中的表达式称为分支表达式。控制表达式通常表示为控制信号的某些为，分支表达式则用这些控制信号的具体状态值来表示，因此分支表达式又可以称为常量表达式。
(2) 当控制表达式的值与分支表达式的值相等时，就执行分支表达式后面的语句。如果所有的分支表达式的值都没有与控制表达式的值相匹配，就执行default后面的语句。
(3) default项可有可无，一个case语句里只能有一个default项。
(4) 每一个case分项的分支表达式的值必须互不相同，否则就会出现问题。
(5) 执行完case分项后的语句，则跳出该case语句结构，终止语句的执行。
(6) 在用case语句表达式进行比较的过程中，只有当信号的对应位的值能明确进行比较时，比较才能成功。因此，要注意详细说明case分项的分支表达式的值。
(7) case语句的所有表达式值的位宽必须相等，只有这样，控制表达式和分支表达式才能进行对于位的比较。一个经常犯的错误时用'bx，'bx来替代n'bx，n'bz，这样写是不对的，因为信号x，z的默认宽度是机器的字节宽度，通常是32位。

case语句与if_else_if语句的区别主要有两点:
(1) 与case语句中的控制表达式和多分枝表达式这种比较结构相比，if_else_if结构中的条件表达式更为直观一点。
(2) 对于那些分支表达式中存在不定值x和高阻值z的位时，case语句提供了处理这种情况的手段。

## 5.5 循环语句
在Verilog HDL中存在着4种类型的循环语句，用来控制执行语句的执行次数。
(1) forever语句:连续的执行语句。
(2) repeat语句:连续执行一条语句n次。
(3) while语句:执行一条语句知道某个条件不满足。如果一开始条件即不满足(为假)，则语句一次也不能被执行。
(4) for语句，先给控制循环次数的变量赋初值，判定控制循环的表达式的值，执行语句。

### 5.5.1 forever语句
forever语句的格式如下:
`forever 语句;` 或 `forever begin 多条语句 end;`

forever循环语句常用于产生周期性的波形，用来作为仿真测试信号。它与always语句不同之处在于不能独立写在程序中，而必须写在initial块中。

### 5.5.2 repeat语句
repeat语句的格式如下:
`repeat(表达式)语句` 或 `repeat(表达式) begin 多条语句 end`

在repeat语句中，其表达式通常为常量表达式。

### 5.5.3 while语句
while语句的格式如下:
`while(表达式)语句` 或 `while(表达式) begin 多条语句 end`

### 5.5.4 for语句
for语句的一般形式为:
`for(表达式1;表达式2;表达式3) 语句`

## 5.6 顺序块和并行块